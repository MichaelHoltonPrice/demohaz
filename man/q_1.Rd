% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/usher3.R
\name{q_1}
\alias{q_1}
\title{Calculate the occupancy probability q_1(x0, x; w)}
\usage{
q_1(x, w, k1, b_siler, x0 = 0, x_cut = Inf, k2 = NULL)
}
\arguments{
\item{x}{The age at which to evaluate the occupancy probability (can be vector)}

\item{w}{A vector of length 2 containing [w_1(x0), w_2(x0)], the state 
weights at age x0. If NULL, computed using calc_weights.}

\item{k1}{The constant transition rate from the healthy state to the ill
state (before x_cut)}

\item{b_siler}{The parameter vector for the Siler hazard model (baseline
mortality)}

\item{x0}{The starting age (default: 0)}

\item{x_cut}{The age at which the well-to-ill transition hazard becomes
zero [default: Inf]}

\item{k2}{Optional k2 parameter (only needed if w is NULL)}
}
\value{
The occupancy probability q_1(x0, x; w) evaluated at x
}
\description{
This function computes the probability of being in state 1 (well) at age x,
given the state weights at age x0. This accounts for survival from x0 to x
while remaining in the well state.
}
\details{
Computes the occupancy probability based on three cases:
- Case x_cut <= x0 <= x: q_1 = w_1(x0) * S_13(0,x) / S_13(0,x0)
- Case x0 <= x_cut <= x: q_1 = w_1(x0) * exp(-k1*(x_cut - x0)) * S_13(0,x) / S_13(0,x0)
- Case x0 <= x <= x_cut: q_1 = w_1(x0) * exp(-k1*(x - x0)) * S_13(0,x) / S_13(0,x0)
}
