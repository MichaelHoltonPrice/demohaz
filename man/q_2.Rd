% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/usher3.R
\name{q_2}
\alias{q_2}
\title{Calculate the occupancy probability q_2(x0, x; w)}
\usage{
q_2(x, w, k1, k2, b_siler, x0 = 0, x_cut = Inf)
}
\arguments{
\item{x}{The age at which to evaluate the occupancy probability (can be vector)}

\item{w}{A vector of length 2 containing [w_1(x0), w_2(x0)], the state 
weights at age x0. If NULL, computed using calc_weights.}

\item{k1}{The constant transition rate from the healthy state to the ill
state (before x_cut)}

\item{k2}{The factor by which the mortality hazard out of the ill state is
larger than that out of the healthy state}

\item{b_siler}{The parameter vector for the Siler hazard model (baseline
mortality)}

\item{x0}{The starting age (default: 0)}

\item{x_cut}{The age at which the well-to-ill transition hazard becomes
zero [default: Inf]}
}
\value{
The occupancy probability q_2(x0, x; w) evaluated at x
}
\description{
This function computes the probability of being in state 2 (ill) at age x,
given the state weights at age x0. This accounts for individuals who were
already ill at x0 and survived, plus individuals who transitioned from well
to ill between x0 and x.
}
\details{
Computes the occupancy probability based on three cases with integral terms
for individuals transitioning from well to ill between x0 and min(x, x_cut).
}
